# ุญู ูุดููุฉ ุชุญููู ุงูุฑุณูุฉ (Async Timing Issue) | Fix Detail

## ุงููุดููุฉ ๐
**ุงููุตู:** ุงูุฑุณูุฉ ูุง ุชุธูุฑ ูู ุงููุญุฑุฑ ุฃู ุงููุนุงููุฉุ ุฑุบู ุฃู ุงูุจูุงูุงุช ููุฌูุฏุฉ ูู Debug.
**ุงูุณุจุจ ุงูุฌุฐุฑู:** ูุดููุฉ ุชูููุช (Timing Issue) ูุน ุงูู Asynchronous Loading ูู Blazor.

### ุงูุณููุงุฑูู ุงูุฐู ูุงู ูุญุฏุซ:
1. ูุชู ูุชุญ ุงูุตูุญุฉ (`OnInitialized`).
2. ูุจุฏุฃ ุทูุจ ุงูุจูุงูุงุช ูู ุงูู API (`await GetByIdAsync`).
3. ุฃุซูุงุก ุงูุชุธุงุฑ ุงูุจูุงูุงุชุ ููุชูู ุงููุชุตูุญ ูู ุงูุฑุณู ุงูุฃููู (Rendering).
4. ุชุนูู ุฏุงูุฉ `OnAfterRenderAsync(firstRender: true)`.
5. ูู ูุฐู ุงููุญุธุฉุ ุงูุจูุงูุงุช `null` (ูุฃููุง ูู ุชุตู ุจุนุฏ).
6. **ูู ุงููุญุฑุฑ:** ุงูููุฏ ูุฑู ุงูุจูุงูุงุช null ููููู ุจุฅูุดุงุก ุฑุณูุฉ **ุฌุฏูุฏุฉ ููุงุฑุบุฉ** (`CreateNewDiagramAsync`).
7. **ูู ุงููุนุงููุฉ:** ุงูููุฏ ูุฑู ุงูุจูุงูุงุช null ููุง ููุนู ุดูุฆุงู.
8. ุชุตู ุงูุจูุงูุงุช ุฃุฎูุฑูุงุ ูุชุชุญุฏุซ ุงูุตูุญุฉ.
9. ุชุนูู `OnAfterRenderAsync(firstRender: false)`.
10. ููู ุงูููุฏ ุงูุฎุงุต ุจุงูุฑุณู ูุงู ุฏุงุฎู `if (firstRender)`ุ ูุฐุง **ูุง ูุนูู ูุฑุฉ ุฃุฎุฑู**.
11. ุงููุชูุฌุฉ: ุฑุณูุฉ ูุงุฑุบุฉ ุฃู ูุง ุดูุก.

## ุงูุญู ๐๏ธ

ูููุง ุจุฅุนุงุฏุฉ ููููุฉ ุงูููุฏ ูู `WorkflowEditor` ู `WorkflowPreview` ููุตู "ุชููุฆุฉ ุงููุญุฑุฑ" ุนู "ุชุญููู ุงูุจูุงูุงุช".

### ุงูุชุบููุฑุงุช ูู WorkflowEditor.razor:
1. **ุชููุฆุฉ ุงููุญุฑุฑ (UI):** ุชุชู ุฏุงุฆููุง ุนูุฏ `firstRender` ูุชุฌููุฒ ุงูู Container.
2. **ุชุญููู ุงูุจูุงูุงุช (Logic):** ูุชู ุงูุชุญูู ููู ูู ูู ุฏูุฑุฉ Render (`if (_isDataLoaded && !_isDiagramLoaded)`).
3. ุจูุฌุฑุฏ ูุตูู ุงูุจูุงูุงุชุ ูุชู ุชุญููููุง ูู ุงููุญุฑุฑ.
4. ุชู ุฅุถุงูุฉ ูุชุบูุฑุงุช ุญุงูุฉ (`_isLoading`, `_isDiagramLoaded`) ูุฅุฏุงุฑุฉ ุงูุนูููุฉ.

### ุงูุชุบููุฑุงุช ูู WorkflowPreview.razor:
1. ุฅุฒุงูุฉ ุดุฑุท `firstRender` ูู ููุทู ุงูุชุญููู.
2. ุงูููุฏ ูุญุงูู ุชููุฆุฉ ุงููุญุฑุฑ ูุชุญููู ุงูุจูุงูุงุช ุทุงููุง ุฃู `_workflow` ููุฌูุฏ ูููู ุงููุญุฑุฑ ูู ูุนูู ุจุนุฏ (`!_isInitialized`).
3. ุฅุถุงูุฉ `Task.Delay(50)` ุตุบูุฑ ููุชุฃูุฏ ูู ุฃู ุนูุตุฑ ุงูู Container ูุฏ ุชู ุฑุณูู ูู ุงูู DOM ูุจู ูุญุงููุฉ ุงูุฑุณู ุนููู.

### ุงูุฎูุงุตุฉ:
ุงูุขูุ ุณูุงุก ูุตูุช ุงูุจูุงูุงุช ุจุณุฑุนุฉ (ูุจู ุงูุฑุณู) ุฃู ุจุจุทุก (ุจุนุฏ ุงูุฑุณู)ุ ุณูุชู ุชุญููู ุงูุฑุณูุฉ ุจุดูู ุตุญูุญ ุชููุงุฆููุง ุจูุฌุฑุฏ ุชููุฑูุง.

## ุงูุชุญูู ูู ุงูุญู โ
1. ุงูุชุญ ุตูุญุฉ Workflows.
2. ุงุฎุชุฑ "Edit" ุฃู "Preview" ูุฃู Workflow ููุฌูุฏ.
3. ุณุชูุงุญุธ ุธููุฑ "Loading..." ุซู ุธููุฑ ุงูุฑุณูุฉ ุจุดูู ุตุญูุญ.
4. ูู ุชุฑู "ุฑุณูุฉ ูุงุฑุบุฉ" ุจุงูุฎุทุฃ.
