# ุชูุงุตูู ูุดุฑูุน ูุตูู ุณูุฑ ุงูุนูู (BPMN Workflow Designer)

## ๐ ูุธุฑุฉ ุนุงูุฉ | Overview
ูุฐุง ุงููุดุฑูุน ุนุจุงุฑุฉ ุนู ุชุทุจูู ููุจ ูุชูุงูู (Full-Stack Web Application) ูุชุตููู ูุฅุฏุงุฑุฉ ูุฎุทุทุงุช ุณูุฑ ุงูุนูู (Business Process Model and Notation - BPMN). ูุณูุญ ูููุณุชุฎุฏููู ุจุฅูุดุงุกุ ุชุนุฏููุ ุญูุธุ ููุนุงููุฉ ุงููุฎุทุทุงุช ุจูุงููุงู ุจุงุณุชุฎุฏุงู ุงููุชุตูุญ.

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ | Architecture & Tech Stack

ูุนุชูุฏ ุงููุดุฑูุน ุนูู ุจููุฉ **Client-Server** ุญุฏูุซุฉ:

### 1. ุฌุงูุจ ุงูุนููู (Client Side)
- **ุงูุฅุทุงุฑ:** Blazor WebAssembly (.NET 7/8).
- **ุงูููุชุจุงุช:**
  - `Radzen.Blazor`: ูููููุงุช ูุงุฌูุฉ ุงููุณุชุฎุฏู (UI Components) ูุซู ุงูุฌุฏุงูู ูุงูุฃุฒุฑุงุฑ.
  - `bpmn-js`: ููุชุจุฉ JavaScript ููุชูุญุฉ ุงููุตุฏุฑ ูุฑุณู ูุนุฑุถ ูุฎุทุทุงุช BPMN.
- **ุงูุชูุงุตู:** ูุณุชุฎุฏู `HttpClient` ููุชุญุฏุซ ูุน ุงูู APIุ ู `IJSRuntime` ููุชุญุฏุซ ูุน JavaScript.

### 2. ุฌุงูุจ ุงูุฎุงุฏู (Server Side)
- **ุงูุฅุทุงุฑ:** ASP.NET Core Web API.
- **ุชุฎุฒูู ุงูุจูุงูุงุช:** ุญุงููุงู ูุณุชุฎุฏู ุชุฎุฒูู ูู ุงูุฐุงูุฑุฉ (In-Memory List) ูุฃุบุฑุงุถ ุงูุชุทููุฑ (ูุชู ูุณุญ ุงูุจูุงูุงุช ุนูุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุณูุฑูุฑ).
- **ุงููุธููุฉ:** ุงุณุชูุจุงู ุทูุจุงุช ุงูู CRUD (ุฅูุดุงุกุ ูุฑุงุกุฉุ ุชุญุฏูุซุ ุญุฐู) ููุนุงูุฌุฉ ูููุงุช XML ู SVG.

---

## ๐ ูููููุฉ ุงููุดุฑูุน | Project Structure

```text
BPMN Workflow Designer/
โโโ Client/ (BpmnWorkflow.Client)
โ   โโโ Pages/
โ   โ   โโโ Workflows.razor       # ูุงุฆูุฉ ุงููุฎุทุทุงุช
โ   โ   โโโ WorkflowEditor.razor  # ูุญุฑุฑ ุงูุฑุณู (ุงูุชุนุฏูู)
โ   โ   โโโ WorkflowPreview.razor # ุตูุญุฉ ุงููุนุงููุฉ (ูุฑุงุกุฉ ููุท)
โ   โ   โโโ WorkflowDebug.razor   # ุตูุญุฉ ูุญุต ุงูุจูุงูุงุช ุงูุฎุงู
โ   โ   โโโ BpmnTest.razor        # ุตูุญุฉ ูุงุฎุชุจุงุฑ ุงูููุชุจุฉ
โ   โโโ Services/
โ   โ   โโโ BpmnInteropService.cs # ุฌุณุฑ ุงูุชูุงุตู ุจูู C# ู JS
โ   โ   โโโ WorkflowService.cs    # ุฎุฏูุฉ ุงูุงุชุตุงู ุจุงูู API
โ   โโโ wwwroot/
โ   โ   โโโ js/
โ   โ   โ   โโโ bpmn-modeler.js   # ููุฏ JavaScript ููุชุญูู ุจุงูููุชุจุฉ ุจุตุฑูุงู
โ   โ   โโโ css/
โ   โ       โโโ app.css           # ุงูุชูุณููุงุช (Scrollbars, etc)
โ
โโโ Server/ (BpmnWorkflow.API)
    โโโ Controllers/
    โ   โโโ WorkflowsController.cs # ููุงุท ุงูุงุชุตุงู (Endpoints)
    โโโ Models/                    # ูุงุฆูุงุช ููู ุงูุจูุงูุงุช (DTOs)
```

---

## ๐ง ุขููุฉ ุงูุนูู (The Core Mechanics)

ุงูุฌุฒุก ุงูุฃูุซุฑ ุชุนููุฏุงู ูุฃูููุฉ ูู ุงููุดุฑูุน ูู ุฏูุฌ ููุชุจุฉ **JavaScript (bpmn-js)** ุฏุงุฎู **Blazor**. ุฅููู ููููุฉ ุนูููุง:

### 1. ุงูุชููุฆุฉ (Initialization)
1. ุชุญุชูู ุตูุญุฉ `WorkflowEditor.razor` ุนูู ุนูุตุฑ `div` ูุงุฑุบ ุจูุนุฑู ูุฑูุฏ (Container ID).
2. ุนูุฏ ุชุดุบูู ุงูุตูุญุฉุ ุชุณุชุฏุนู `BpmnInterop.InitializeAsync`.
3. ูููู ููุฏ JavaScript (`bpmn-modeler.js`) ุจุฅูุดุงุก ูุณุฎุฉ ูู `BpmnJS` ูุฑุจุทูุง ุจูุฐุง ุงูู `div`.

### 2. ุชุญููู ุงูุจูุงูุงุช (Async Loading)
ูุญู ูุดููุฉ ุงูุชูููุช (Timing Issue):
- ูุชู ุชููุฆุฉ ุงูู DOM ุฃููุงู.
- ูุชู ุฌูุจ ุงูุจูุงูุงุช ูู ุงูู API ุจุดูู ุบูุฑ ูุชุฒุงูู.
- ุจูุฌุฑุฏ ูุตูู ุงูุจูุงูุงุชุ ูุชู ุงุณุชุฏุนุงุก `importXML` ูู JavaScript ูุฑุณู ุงููุฎุทุท.

### 3. ุงูุญูุธ (Saving)
1. ูุถุบุท ุงููุณุชุฎุฏู ุนูู ุฒุฑ "Save".
2. ุชุทูุจ Blazor ูู JavaScript ุงุณุชุฎุฑุงุฌ ุงูุจูุงูุงุช:
   - `exportXML`: ููุญุตูู ุนูู ูููู ุงูุฑุณูุฉ.
   - `exportSVG`: ููุญุตูู ุนูู ุตูุฑุฉ ูุนุงููุฉ.
3. ูุชู ุฅุฑุณุงู ูุฐู ุงูุจูุงูุงุช ุนุจุฑ `WorkflowService` ุฅูู ุงูู API ููุชู ุญูุธูุง.

---

## โจ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ | Key Features

### 1. ุงููุญุฑุฑ ุงูุชูุงุนูู (Editor)
- ุณุญุจ ูุฅููุงุช ุงูุนูุงุตุฑ (Drag & Drop).
- ููุญุฉ ุฃุฏูุงุช (Palette) ุนูู ุงููุณุงุฑ.
- ุฎุตุงุฆุต ุงูุนูุงุตุฑ (Properties Panel) - *ูููู ุชุทููุฑูุง ูุณุชูุจูุงู*.
- ุฃุฏูุงุช ุชุญูู ูุฎุตุตุฉ (Zoom In, Zoom Out, Fit, Actual Size).
- ุดุฑูุท ุชูุฑูุฑ ูุฎุตุต (Custom Scrollbar).

### 2. ูุถุน ุงููุนุงููุฉ (Preview Mode)
- ุนุฑุถ ุงูุฑุณูุฉ ูู ูุถุน ุงููุฑุงุกุฉ ููุท.
- ููุณ ุฃุฏูุงุช ุงูุชุญูู ูู ุงูุชูุจูุฑ ูุงูุชุตุบูุฑ.
- ูููุฏ ูููุฑุงุฌุนุฉ ุฏูู ุงูุฎูู ูู ุชุบููุฑ ุงูุฑุณูุฉ ุจุงูุฎุทุฃ.

### 3. ุฃุฏูุงุช ุงูุชุดุฎูุต (Debugging Tools)
- **Workflow Debug Page:** ุชุนุฑุถ ููุฏ XML ุงูุฎุงู ูุชูุงุตูู ุงูู SVG ููุชุฃูุฏ ูู ุฃู ุงูุจูุงูุงุช ุชูุญูุธ ุจุดูู ุตุญูุญ.
- **Console Logging:** ุชู ุฅุถุงูุฉ ุณุฌูุงุช (Logs) ุชูุตูููุฉ ูู ุงููุชุตูุญ ูุชุชุจุน ุฎุทูุงุช ุงูุชุญููู ูุงูุญูุธ.

---

## ๐ ุงููุดุงูู ุงูุชู ุชู ุญููุง | Solved Issues

### 1. ูุดููุฉ ุงูุชูููุช (Async Loading)
**ุงููุดููุฉ:** ูุงูุช ุงูุตูุญุฉ ุชุญุงูู ุฑุณู ุงููุฎุทุท ูุจู ูุตูู ุงูุจูุงูุงุช ูู ุงูุณูุฑูุฑุ ููุง ูุคุฏู ูุธููุฑ ุตูุญุฉ ูุงุฑุบุฉ.
**ุงูุญู:** ูุตููุง ุนูููุฉ "ุชููุฆุฉ ุงููุญุฑุฑ" ุนู "ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช"ุ ูุฌุนููุง ุงูุงุณุชูุฑุงุฏ ููุชุธุฑ ูุตูู ุงูุจูุงูุงุช.

### 2. ูุดููุฉ ุงูุญูุธ (Failed to Fetch)
**ุงููุดููุฉ:** ุนุฏู ุชุทุงุจู ุงูููุงูุฐ (Ports) ุจูู ุงูุนููู ูุงูุณูุฑูุฑ.
**ุงูุญู:** ุถุจุท ูููุงุช `launchSettings.json` ูุชุนูู ุนูู ููุงูุฐ HTTPS ุงูุตุญูุญุฉ ูุชูููู CORS.

### 3. ูุงุฌูุฉ ุงููุณุชุฎุฏู (UI/UX)
**ุงูุชุญุณููุงุช:**
- ุฅุถุงูุฉ Scrollbar ูุฎุตุต.
- ุชูุจูุฑ ูุณุงุญุฉ ุงูุฑุณู.
- ุฅุถุงูุฉ ุฃุฒุฑุงุฑ ุชุญูู ุนูููุฉ ุจุฏูุงู ูู ุงูุงุนุชูุงุฏ ุนูู ุงูุงุฎุชุตุงุฑุงุช ููุท.

---

## ๐ ุงูุชุทููุฑ ุงููุณุชูุจูู | Future Improvements

1. **ูุงุนุฏุฉ ุจูุงูุงุช ุญููููุฉ:** ุงุณุชุจุฏุงู ุงููุงุฆูุฉ ุงููุคูุชุฉ ุจู SQL Server ุฃู SQLite.
2. **ุดุฑูุท ุงูุฎุตุงุฆุต (Properties Panel):** ุงูุณูุงุญ ูููุณุชุฎุฏู ุจุชุบููุฑ ุฃุณูุงุก ุงูุนูุงุตุฑ ูุฎุตุงุฆุตูุง ูู ูุงุฌูุฉ ุฌุงูุจูุฉ.
3. **ุงูุชุตุฏูุฑ:** ุฅุถุงูุฉ ุฒุฑ ูุชุญููู ุงูุฑุณูุฉ ูููู ุตูุฑุฉ (PNG) ุฃู ููู (BPMN) ุนูู ุฌูุงุฒ ุงููุณุชุฎุฏู.
4. **Validation:** ุงูุชุญูู ูู ุตุญุฉ ุงูุฑุณูุฉ ูุจู ุงูุญูุธ (ูุซูุงู: ุงูุชุฃูุฏ ูู ูุฌูุฏ ููุทุฉ ุจุฏุงูุฉ ูููุงูุฉ).
